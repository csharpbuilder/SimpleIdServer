
<div id="workflowEditor" @ref="@svgContainer">
    <svg @ref="@svgRef"
    viewBox="@viewBox">
        <defs>
            <marker id='head'
            orient="auto"
            markerWidth='3'
            markerHeight='4'
            refX='0.1'
            refY='2'>
                <path d='M0,0 V4 L2,2 Z' fill="black" />
            </marker>
            <marker id='headSelected'
            orient="auto"
            markerWidth='3'
            markerHeight='4'
            refX='0.1'
            refY='2'>
                <path d='M0,0 V4 L2,2 Z' fill="red" />
            </marker>
        </defs>
        <!-- Display all the steps -->
        @foreach (var step in Context.Definition.Workflow.Steps)
        {
            <foreignObject x="@Sanitize(step.Coordinate.X)" y="@Sanitize(step.Coordinate.Y)" height="@stepSize.height" width="@stepSize.width">
                <div>
                    @step.Id
                </div>
            </foreignObject>
        }

        <!-- Display all the step links -->
        @foreach (var link in Context.Definition.Workflow.Links)
        {
            <path marker-end="@(link.IsHover ? "url(#headSelected)" : "url(#head)")" stroke-width="2" fill="none" stroke="@(link.IsHover ? "red" : "black")" d="@GetLinkCoordinate(link)"></path>
        }

        <!-- Display all empty steps -->
        @foreach (var emptyStep in emptySteps)
        {
            <foreignObject x="@Sanitize(emptyStep.Coordinate.X)" y="@Sanitize(emptyStep.Coordinate.Y)" height="@stepSize.height" width="@stepSize.width">
                <div style="background-color: lightblue; height: 100%; display: flex; align-items: center; justify-content: center;">
                    <button @onclick="(async () => await Add(emptyStep))" style="padding: 10px 20px; font-size: 16px; border-radius: 5px; border: none; background-color: #007bff; color: white; cursor: pointer;">
                        Add a step
                    </button>
                </div>
            </foreignObject>
        }
    </svg>
</div>